    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="egov.contactdirectory">
<body>

<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
           tal:define="kssClassesView context/@@kss_field_decorator_view;
                       getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                       templateId template/getId">

           <div tal:replace="structure provider:plone.abovecontenttitle" />
           <h1 class="documentFirstHeading" tal:content="context/pretty_title_or_id">Title or id</h1>
           <div tal:replace="structure provider:plone.belowcontenttitle" />

        <div tal:define="beschreibung here/getDescription | nothing;
        				  bio here/getText | nothing;"
        	  class="contact_view">
        				  
            <div class="rightFloat" tal:define="portrait here/getImage | nothing">
              <img tal:condition="portrait" class="floatRight"
                   tal:attributes="src string:${portrait/absolute_url}_thumbnail;
                             alt string:${here/getFirstname}, ${here/getLastname}" />
            </div>
            <h2><span tal:replace="string: ${here/getFirstname | nothing} ${here/getLastname | nothing} ">Name</span></h2>
	        <p>

		    	<span tal:replace="beschreibung" />
		    	<span tal:replace="here/getFunction | nothing" /><br /><br />
		    	
		    	<span tal:replace="context/getOrganization|nothing"/><br />
	            <span tal:replace="context/getDepartment|nothing"/><br />
		    	<span tal:replace="structure python: here.getAddress() and str(here.getAddress()).replace('\n', '<br />') or ''" /><br />
		    	<span tal:replace="here/getZip | nothing" />
		    	<span tal:replace="here/getCity | nothing" /><br /><br />
		    	<tal:block tal:condition="here/getPhone_office"><span i18n:translate="label_phone_office">Phone number (office)</span><span  tal:replace="string:: ${here/getPhone_office | nothing}" /><br /></tal:block>
		    	<tal:block tal:condition="here/getPhone_mobile"><span i18n:translate="label_phone_mobile">Mobile number</span><span  tal:replace="string:: ${here/getPhone_mobile | nothing}" /><br /></tal:block>
		    	<tal:block tal:condition="here/getFax"><span i18n:translate="label_fax">Fax number</span><span  tal:replace="string:: ${here/getFax | nothing}" /><br /></tal:block>
		    	<span tal:condition="here/getEmail">
			        <a tal:replace="structure python:context.spamProtect(mailaddress=here.getEmail())"/><br />
                </span>
                <a tal:define="url here/getWww;
                               ishttps python:url.find('https') != -1;
                               ishttp python:url.find('http') != -1;
                               formatted_url python:ishttps and url.replace('https://','') or url;
                               formatted_url python:(ishttp and not ishttps) and url.replace('http://','') or formatted_url"
                   tal:condition="here/getWww" 
                   tal:content="formatted_url"
                   tal:attributes="href here/getWww"
                   title="externer Link (&ouml;ffnet neuem Fenster)"
                   target="_blank" />
			</p>	        	
            <metal:block tal:define="memberships here/getMemberships" tal:condition="memberships">
            <h3 i18n:translate="label_memberships">
            Memberships
            </h3>

    <ul>
        <tal:items tal:repeat="obj memberships">
      	<li>
      	  <a href="" tal:attributes="href string:${obj/absolute_url}"><span tal:condition="obj/getOrganization" tal:replace="obj/getOrganization"/> <span tal:condition="obj/getFunction" tal:replace="string:(${obj/getFunction})"/></a>
      	</li>
      </tal:items>
    </ul>
    </metal:block>
		<div class="zugMitglied-bio" tal:content="structure bio | nothing">Text</div>
	  </div>

<dl id="map" class="collapsible"
             tal:define="view context/@@maps_googlemaps_view | nothing;
                         showPlacemark context/getShowPlacemark | nothing"
             tal:condition="python: view and showPlacemark">
<!--
XXX: mit "collapsedOnLoad" als weitere klasse wird die karte zusammengeklappt geladen. das fÃ¼hrt aber dazu, dass die karte nicht richtig angezeigt wird. Deshalb ein workaround:
-->
<script type="text/javascript">
jq(document).ready(function() {
	hideMap = function() {jq("dl#map dt.collapsibleHeader").click();};
	window.setTimeout("hideMap()", 1000);
});
</script>
<dt class="collapsibleHeader">Karte</dt>
<dd class="collapsibleContent">

        <div class="googleMapView floatLeft">
          <dl metal:define-macro="markers">
          <tal:markers tal:repeat="marker view/getMarkers">
            <dt class="title">
              <img src="" tal:replace="structure python:view.iconTagForMarker(marker)" />
              <a href=""
                 tal:attributes="href marker/url"
                 tal:content="marker/title"> Title </a>
            </dt>
            <dd class="tab"
                title="Description"
                tal:condition="marker/description"
                i18n:attributes="title label_description;">
              <div tal:content="marker/description" />
            </dd>
            <dd class="tab"
                tal:condition="marker/contents | nothing"
                tal:repeat="content marker/contents"
                tal:attributes="title content/title">
              <div tal:replace="structure content/text" />
              <div class="visualClear"><!-- --></div>
            </dd>
            <dd class="geo">
              <span class="latitude" tal:content="marker/latitude" />
              <span class="longitude" tal:content="marker/longitude" />
            </dd>
            <dd class="layers"
                tal:condition="marker/layers | nothing">
              <ul>
                <li tal:repeat="layer marker/layers"
                    tal:content="layer">Layer</li>
              </ul>
            </dd>
            <tal:block tal:condition="marker/related_items | nothing">
              <dt i18n:translate="label_related_items">Related Items</dt>
              <dd>
                <tal:related tal:repeat="related marker/related_items">
                  <a href=""
                     tal:attributes="href related/url;
                                     title related/description | nothing"
                     tal:content="related/title" />
                </tal:related>
              </dd>
            </tal:block>
          </tal:markers>
          </dl>
        </div>
        


</dd> </dl>

        <div metal:use-macro="here/document_relateditems/macros/relatedItems">
            show related items if they exist
        </div>
    
        <div tal:replace="structure provider:plone.belowcontentbody" />

    </tal:main-macro>
</metal:main>

</body>
</html>
